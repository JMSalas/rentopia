{% extends 'web_app/base/base.html' %}

{% block content %}
<div class="container py-5">
    <div class="row">
        <div class="col-8 mx-auto shadow text-center border-top">
            <div class="h1 border-bottom py-4 text-center">
                {% if user.is_authenticated %}Editar Usuario{% else %}Registrar Usuario{% endif %}
            </div>
            <!-- Forms Errors -->
            {% if all_errors %}
                <div class="alert alert-danger">
                    <ul>
                    {% for field, errors in all_errors.items %}
                        {% for error in errors %}
                            <li>{{ field }}: {{ error }}</li>
                        {% endfor %}
                    {% endfor %}
                    </ul>
                </div>
            {% endif %}
            
            <!-- Forms -->
            <form method="post">
                {% csrf_token %}
                <div class="h3 border-bottom py-3 text-center">Información de la Cuenta</div>
                {{ user_form.username.label_tag }}<br>{{ user_form.username }} <br>    
                
                {% if not user.is_authenticated %}
                    {{ user_form.password1.label_tag }}<br>{{ user_form.password1 }}<br>
                    {{ user_form.password2.label_tag }}<br>{{ user_form.password2 }}<br>
                {% else %}
                    <div class="py-3">
                        Contraseña<br>{{ user.password }}<br>
                        <a href="{% url 'wip'%}">Cambiar Contraseña</a><br>
                    </div>
                {% endif %}

                {{ profile_form.tipo.label_tag }}<br>{{ profile_form.tipo }}<br>
        
                <div class="h3 border-bottom py-3 text-center">Información Personal</div>
                {{ user_form.first_name.label_tag }}<br>{{ user_form.first_name }}<br>
                {{ user_form.last_name.label_tag }}<br>{{ user_form.last_name }}<br>
                {{ profile_form.rut.label_tag }}<br>{{ profile_form.rut }}<br>
                {{ user_form.email.label_tag }}<br>{{ user_form.email }}<br>
                {{ profile_form.telefono.label_tag }}<br>{{ profile_form.telefono }}<br>
                        
                <div class="h3 border-bottom py-3 text-center">Dirección</div>
                {{ dir_form.calle.label_tag }}<br>{{ dir_form.calle }}<br>
                {{ dir_form.numero.label_tag }}<br>{{ dir_form.numero }}<br>
                {{ dir_form.dpto.label_tag }}<br>{{ dir_form.dpto }}<br>
                {{ dir_form.comuna.label_tag }}<br>{{ dir_form.comuna }}<br>

                <div class="py-3 text-center">
                    {% if user.is_authenticated %}
                        <a href="{% url 'profile' %}" class="btn btn-secondary">Volver</a>
                    {% endif %}
                    <button type="submit" class="btn btn-primary">{% if user.is_authenticated %}Guardar{% else %}Registrar{% endif %}</button>  
                </div>
            </form>   
        </div>    
    </div>
</div>
{% endblock %}